<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="655px" preserveAspectRatio="none" style="width:1645px;height:655px;" version="1.1" viewBox="0 0 1645 655" width="1645px" zoomAndPan="magnify"><defs><filter height="300%" id="f19x3xhnhh8pf3" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[335f4d9be48430461c68bf6d6fdba145]
class App--><rect codeLine="2" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="60.8047" id="App" style="stroke:#A80036;stroke-width:1.5;" width="160" x="901" y="7"/><ellipse cx="964.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M967.7188,28.6406 Q967.1406,28.9375 966.5,29.0781 Q965.8594,29.2344 965.1563,29.2344 Q962.6563,29.2344 961.3281,27.5938 Q960.0156,25.9375 960.0156,22.8125 Q960.0156,19.6875 961.3281,18.0313 Q962.6563,16.375 965.1563,16.375 Q965.8594,16.375 966.5,16.5313 Q967.1563,16.6875 967.7188,16.9844 L967.7188,19.7031 Q967.0938,19.125 966.5,18.8594 Q965.9063,18.5781 965.2813,18.5781 Q963.9375,18.5781 963.25,19.6563 Q962.5625,20.7188 962.5625,22.8125 Q962.5625,24.9063 963.25,25.9844 Q963.9375,27.0469 965.2813,27.0469 Q965.9063,27.0469 966.5,26.7813 Q967.0938,26.5 967.7188,25.9219 L967.7188,28.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="24" x="985.25" y="27.1543">App</text><line style="stroke:#A80036;stroke-width:1.5;" x1="902" x2="1060" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="909" y="47"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="921" y="53.2104">SERVER_SECRET: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="902" x2="1060" y1="59.8047" y2="59.8047"/><!--MD5=[1f1f201fabd7e91782bcb1bb8a0d84c9]
class TokenContent--><rect codeLine="6" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="73.6094" id="TokenContent" style="stroke:#A80036;stroke-width:1.5;" width="134" x="7" y="327.5"/><ellipse cx="28.3" cy="343.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M31.2688,349.1406 Q30.6906,349.4375 30.05,349.5781 Q29.4094,349.7344 28.7063,349.7344 Q26.2063,349.7344 24.8781,348.0938 Q23.5656,346.4375 23.5656,343.3125 Q23.5656,340.1875 24.8781,338.5313 Q26.2063,336.875 28.7063,336.875 Q29.4094,336.875 30.05,337.0313 Q30.7063,337.1875 31.2688,337.4844 L31.2688,340.2031 Q30.6438,339.625 30.05,339.3594 Q29.4563,339.0781 28.8313,339.0781 Q27.4875,339.0781 26.8,340.1563 Q26.1125,341.2188 26.1125,343.3125 Q26.1125,345.4063 26.8,346.4844 Q27.4875,347.5469 28.8313,347.5469 Q29.4563,347.5469 30.05,347.2813 Q30.6438,347 31.2688,346.4219 L31.2688,349.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="88" x="43.7" y="347.6543">TokenContent</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="140" y1="359.5" y2="359.5"/><ellipse cx="18" cy="370.5" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="27" y="373.7104">username: string</text><ellipse cx="18" cy="383.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="27" y="386.5151">expiration: number</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="140" y1="393.1094" y2="393.1094"/><!--MD5=[2c8b070088f9e9a5dfda32644ea219c6]
class AuthenticationController--><rect codeLine="11" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="124.8281" id="AuthenticationController" style="stroke:#A80036;stroke-width:1.5;" width="354" x="804" y="129"/><ellipse cx="900.25" cy="145" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M903.2188,150.6406 Q902.6406,150.9375 902,151.0781 Q901.3594,151.2344 900.6563,151.2344 Q898.1563,151.2344 896.8281,149.5938 Q895.5156,147.9375 895.5156,144.8125 Q895.5156,141.6875 896.8281,140.0313 Q898.1563,138.375 900.6563,138.375 Q901.3594,138.375 902,138.5313 Q902.6563,138.6875 903.2188,138.9844 L903.2188,141.7031 Q902.5938,141.125 902,140.8594 Q901.4063,140.5781 900.7813,140.5781 Q899.4375,140.5781 898.75,141.6563 Q898.0625,142.7188 898.0625,144.8125 Q898.0625,146.9063 898.75,147.9844 Q899.4375,149.0469 900.7813,149.0469 Q901.4063,149.0469 902,148.7813 Q902.5938,148.5 903.2188,147.9219 L903.2188,150.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="153" x="920.75" y="149.1543">AuthenticationController</text><line style="stroke:#A80036;stroke-width:1.5;" x1="805" x2="1157" y1="161" y2="161"/><line style="stroke:#A80036;stroke-width:1.5;" x1="805" x2="1157" y1="169" y2="169"/><ellipse cx="815" cy="180" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="241" x="824" y="183.2104">signUp(req: SignUpReq, res: Object) : void</text><ellipse cx="815" cy="192.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="309" x="824" y="196.0151">validateEmail(req: ValidateEmailReq, res: Object): void</text><ellipse cx="815" cy="205.6094" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="824" y="208.8198">login(req: LoginReq, res: Object) : void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="812" y="215.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="324" x="824" y="221.6245">signToken(content: TokenContent, secret: string) : string</text><ellipse cx="815" cy="231.2188" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="248" x="824" y="234.4292">refresh(req: RefreshReq, res: Object) : void</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="812" y="241.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="328" x="824" y="247.2339">extractToken(token: string, secret: string) : TokenContent</text><!--MD5=[b5cc3f0ec37ba1876136adb0be072551]
class ValidateEmail--><rect codeLine="77" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="99.2188" id="ValidateEmail" style="stroke:#A80036;stroke-width:1.5;" width="332" x="176" y="315"/><ellipse cx="295.75" cy="331" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M298.7188,336.6406 Q298.1406,336.9375 297.5,337.0781 Q296.8594,337.2344 296.1563,337.2344 Q293.6563,337.2344 292.3281,335.5938 Q291.0156,333.9375 291.0156,330.8125 Q291.0156,327.6875 292.3281,326.0313 Q293.6563,324.375 296.1563,324.375 Q296.8594,324.375 297.5,324.5313 Q298.1563,324.6875 298.7188,324.9844 L298.7188,327.7031 Q298.0938,327.125 297.5,326.8594 Q296.9063,326.5781 296.2813,326.5781 Q294.9375,326.5781 294.25,327.6563 Q293.5625,328.7188 293.5625,330.8125 Q293.5625,332.9063 294.25,333.9844 Q294.9375,335.0469 296.2813,335.0469 Q296.9063,335.0469 297.5,334.7813 Q298.0938,334.5 298.7188,333.9219 L298.7188,336.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="316.25" y="335.1543">ValidateEmail</text><line style="stroke:#A80036;stroke-width:1.5;" x1="177" x2="507" y1="347" y2="347"/><ellipse cx="187" cy="358" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="210" x="196" y="361.2104">userToToken: Map&lt;ObjectId, string&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="177" x2="507" y1="367.8047" y2="367.8047"/><ellipse cx="187" cy="378.8047" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="306" x="196" y="382.0151">sendTokenToEmail(user: ObjectId, email: string): void</text><ellipse cx="187" cy="391.6094" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="287" x="196" y="394.8198">checkToken(user: ObjectId, token: string): boolean</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="184" y="401.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="196" y="407.6245">generateValidationToken(): string</text><!--MD5=[bf1f63756adf75f7ecdeacd63242982d]
class SignUpReq--><rect codeLine="23" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="86.4141" id="SignUpReq" style="stroke:#A80036;stroke-width:1.5;" width="152" x="543" y="321.5"/><ellipse cx="581.4" cy="337.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M577.3219,333.2656 L577.3219,331.1094 L584.7125,331.1094 L584.7125,333.2656 L582.2438,333.2656 L582.2438,341.3438 L584.7125,341.3438 L584.7125,343.5 L577.3219,343.5 L577.3219,341.3438 L579.7906,341.3438 L579.7906,333.2656 L577.3219,333.2656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="68" x="600.6" y="341.6543">SignUpReq</text><line style="stroke:#A80036;stroke-width:1.5;" x1="544" x2="694" y1="353.5" y2="353.5"/><ellipse cx="554" cy="364.5" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="563" y="367.7104">email: string</text><ellipse cx="554" cy="377.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="563" y="380.5151">username: string</text><ellipse cx="554" cy="390.1094" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="563" y="393.3198">passwordHash: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="544" x2="694" y1="399.9141" y2="399.9141"/><!--MD5=[657c1d01b99145a82e031c80cde6b9c8]
class ValidateEmailReq--><rect codeLine="29" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="60.8047" id="ValidateEmailReq" style="stroke:#A80036;stroke-width:1.5;" width="140" x="730" y="334"/><ellipse cx="745" cy="350" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M740.9219,345.7656 L740.9219,343.6094 L748.3125,343.6094 L748.3125,345.7656 L745.8438,345.7656 L745.8438,353.8438 L748.3125,353.8438 L748.3125,356 L740.9219,356 L740.9219,353.8438 L743.3906,353.8438 L743.3906,345.7656 L740.9219,345.7656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="108" x="759" y="354.1543">ValidateEmailReq</text><line style="stroke:#A80036;stroke-width:1.5;" x1="731" x2="869" y1="366" y2="366"/><ellipse cx="741" cy="377" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="750" y="380.2104">token: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="731" x2="869" y1="386.8047" y2="386.8047"/><!--MD5=[c261b89841acff94ebe7e695b23dc22b]
class LoginReq--><rect codeLine="33" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="73.6094" id="LoginReq" style="stroke:#A80036;stroke-width:1.5;" width="152" x="905" y="327.5"/><ellipse cx="947.9" cy="343.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M943.8219,339.2656 L943.8219,337.1094 L951.2125,337.1094 L951.2125,339.2656 L948.7438,339.2656 L948.7438,347.3438 L951.2125,347.3438 L951.2125,349.5 L943.8219,349.5 L943.8219,347.3438 L946.2906,347.3438 L946.2906,339.2656 L943.8219,339.2656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="58" x="968.1" y="347.6543">LoginReq</text><line style="stroke:#A80036;stroke-width:1.5;" x1="906" x2="1056" y1="359.5" y2="359.5"/><ellipse cx="916" cy="370.5" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="925" y="373.7104">username: string</text><ellipse cx="916" cy="383.3047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="925" y="386.5151">passwordHash: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="906" x2="1056" y1="393.1094" y2="393.1094"/><!--MD5=[595dc81cf4b779cf924885e1bf70d0cb]
class LoginRes--><rect codeLine="37" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="73.6094" id="LoginRes" style="stroke:#A80036;stroke-width:1.5;" width="146" x="995" y="529"/><ellipse cx="1036.1" cy="545" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1032.0219,540.7656 L1032.0219,538.6094 L1039.4125,538.6094 L1039.4125,540.7656 L1036.9438,540.7656 L1036.9438,548.8438 L1039.4125,548.8438 L1039.4125,551 L1032.0219,551 L1032.0219,548.8438 L1034.4906,548.8438 L1034.4906,540.7656 L1032.0219,540.7656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="56" x="1055.9" y="549.1543">LoginRes</text><line style="stroke:#A80036;stroke-width:1.5;" x1="996" x2="1140" y1="561" y2="561"/><ellipse cx="1006" cy="572" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="1015" y="575.2104">access_token: string</text><ellipse cx="1006" cy="584.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="1015" y="588.0151">refresh_token: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="996" x2="1140" y1="594.6094" y2="594.6094"/><!--MD5=[2b41c1218da8f2d2d7879c0f580de5d0]
class RefreshReq--><rect codeLine="43" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="60.8047" id="RefreshReq" style="stroke:#A80036;stroke-width:1.5;" width="146" x="1163" y="334"/><ellipse cx="1197.35" cy="350" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1193.2719,345.7656 L1193.2719,343.6094 L1200.6625,343.6094 L1200.6625,345.7656 L1198.1938,345.7656 L1198.1938,353.8438 L1200.6625,353.8438 L1200.6625,356 L1193.2719,356 L1193.2719,353.8438 L1195.7406,353.8438 L1195.7406,345.7656 L1193.2719,345.7656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="71" x="1215.65" y="354.1543">RefreshReq</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1164" x2="1308" y1="366" y2="366"/><ellipse cx="1174" cy="377" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="120" x="1183" y="380.2104">refresh_token: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1164" x2="1308" y1="386.8047" y2="386.8047"/><!--MD5=[8f785c9c405d286e477f8762e0176cd0]
class RefreshRes--><rect codeLine="46" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="60.8047" id="RefreshRes" style="stroke:#A80036;stroke-width:1.5;" width="173" x="1199.5" y="535.5"/><ellipse cx="1247.25" cy="551.5" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1243.1719,547.2656 L1243.1719,545.1094 L1250.5625,545.1094 L1250.5625,547.2656 L1248.0938,547.2656 L1248.0938,555.3438 L1250.5625,555.3438 L1250.5625,557.5 L1243.1719,557.5 L1243.1719,555.3438 L1245.6406,555.3438 L1245.6406,547.2656 L1243.1719,547.2656 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="1267.75" y="555.6543">RefreshRes</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1200.5" x2="1371.5" y1="567.5" y2="567.5"/><ellipse cx="1210.5" cy="578.5" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="147" x="1219.5" y="581.7104">new_access_token: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1200.5" x2="1371.5" y1="588.3047" y2="588.3047"/><!--MD5=[c2d105e52fbb731d58293327cfa51995]
class UserModel--><rect codeLine="60" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="60.8047" id="UserModel" style="stroke:#A80036;stroke-width:1.5;" width="216" x="1415" y="334"/><ellipse cx="1485.75" cy="350" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1488.7188,355.6406 Q1488.1406,355.9375 1487.5,356.0781 Q1486.8594,356.2344 1486.1563,356.2344 Q1483.6563,356.2344 1482.3281,354.5938 Q1481.0156,352.9375 1481.0156,349.8125 Q1481.0156,346.6875 1482.3281,345.0313 Q1483.6563,343.375 1486.1563,343.375 Q1486.8594,343.375 1487.5,343.5313 Q1488.1563,343.6875 1488.7188,343.9844 L1488.7188,346.7031 Q1488.0938,346.125 1487.5,345.8594 Q1486.9063,345.5781 1486.2813,345.5781 Q1484.9375,345.5781 1484.25,346.6563 Q1483.5625,347.7188 1483.5625,349.8125 Q1483.5625,351.9063 1484.25,352.9844 Q1484.9375,354.0469 1486.2813,354.0469 Q1486.9063,354.0469 1487.5,353.7813 Q1488.0938,353.5 1488.7188,352.9219 L1488.7188,355.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="1506.25" y="354.1543">UserModel</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1416" x2="1630" y1="366" y2="366"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1416" x2="1630" y1="374" y2="374"/><ellipse cx="1426" cy="385" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="190" x="1435" y="388.2104">findOne(username: string) : User</text><!--MD5=[3fd616f346a44cd59a91eb10b19e157c]
class User--><rect codeLine="66" fill="#FEFECE" filter="url(#f19x3xhnhh8pf3)" height="150.4375" id="User" style="stroke:#A80036;stroke-width:1.5;" width="184" x="1431" y="491"/><ellipse cx="1504.25" cy="507" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1507.2188,512.6406 Q1506.6406,512.9375 1506,513.0781 Q1505.3594,513.2344 1504.6563,513.2344 Q1502.1563,513.2344 1500.8281,511.5938 Q1499.5156,509.9375 1499.5156,506.8125 Q1499.5156,503.6875 1500.8281,502.0313 Q1502.1563,500.375 1504.6563,500.375 Q1505.3594,500.375 1506,500.5313 Q1506.6563,500.6875 1507.2188,500.9844 L1507.2188,503.7031 Q1506.5938,503.125 1506,502.8594 Q1505.4063,502.5781 1504.7813,502.5781 Q1503.4375,502.5781 1502.75,503.6563 Q1502.0625,504.7188 1502.0625,506.8125 Q1502.0625,508.9063 1502.75,509.9844 Q1503.4375,511.0469 1504.7813,511.0469 Q1505.4063,511.0469 1506,510.7813 Q1506.5938,510.5 1507.2188,509.9219 L1507.2188,512.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="1524.75" y="511.1543">User</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1432" x2="1614" y1="523" y2="523"/><ellipse cx="1442" cy="534" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="1451" y="537.2104">id: ObjectId</text><ellipse cx="1442" cy="546.8047" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="1451" y="550.0151">email: string</text><ellipse cx="1442" cy="559.6094" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="135" x="1451" y="562.8198">validatedEmail: boolean</text><ellipse cx="1442" cy="572.4141" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1451" y="575.6245">username: string</text><ellipse cx="1442" cy="585.2188" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="1451" y="588.4292">passwordHash: string</text><ellipse cx="1442" cy="598.0234" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="1451" y="601.2339">authToken: string</text><ellipse cx="1442" cy="610.8281" fill="none" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="117" x="1451" y="614.0386">refreshToken: string</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1432" x2="1614" y1="620.6328" y2="620.6328"/><ellipse cx="1442" cy="631.6328" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="1451" y="634.8433">isValidPassword() : boolean</text><!--MD5=[349429ef4703781a5b48ce9adfc11579]
link AuthenticationController to TokenContent--><path codeLine="20" d="M803.84,199.72 C633.99,211.05 372.48,240.17 158,315 C150.23,317.71 142.37,321.15 134.73,324.95 " fill="none" id="AuthenticationController-to-TokenContent" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="130.01,327.36,139.845,326.8374,134.4649,325.0897,136.2126,319.7096,130.01,327.36" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[85f68458ed8154216169c030409ac543]
link AuthenticationController to ValidateEmail--><path codeLine="21" d="M803.85,239.91 C713.14,264.18 603.18,293.61 513.31,317.66 " fill="none" id="AuthenticationController-to-ValidateEmail" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="508.23,319.02,517.9604,320.5427,513.0581,317.7201,515.8806,312.8178,508.23,319.02" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[6e22055566f2c5cf6cc270c0daff2a43]
link LoginReq to LoginRes--><!--MD5=[4fa773ce058c6cc5fca8d9ed756b3c3b]
link RefreshReq to RefreshRes--><!--MD5=[9f5d5ff34f56b09567e5cbcd262251be]
link AuthenticationController to SignUpReq--><path codeLine="51" d="M842.11,254.04 C800.09,273.12 753.97,294.52 712,315 C707.97,316.96 703.86,319 699.72,321.07 " fill="none" id="AuthenticationController-to-SignUpReq" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="695.22,323.34,705.0581,322.8802,699.6893,321.0982,701.4713,315.7294,695.22,323.34" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[e74d94e3e628c7fb757da411b69881a2]
link AuthenticationController to LoginReq--><path codeLine="52" d="M981,254.23 C981,276.81 981,301.79 981,322.16 " fill="none" id="AuthenticationController-to-LoginReq" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="981,327.24,985,318.24,981,322.24,977,318.24,981,327.24" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[1d670a76dc1ea9c59cc8c2373eab67db]
link AuthenticationController to LoginRes--><path codeLine="53" d="M1039.87,254.02 C1053.78,272.27 1066.67,293.24 1074,315 C1097.63,385.21 1087.09,472.9 1077.44,523.57 " fill="none" id="AuthenticationController-to-LoginRes" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="1076.45,528.66,1082.1012,520.5938,1077.4086,523.7527,1074.2496,519.0601,1076.45,528.66" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a2638a6c726f04bd37c85a15e24d4133]
link AuthenticationController to RefreshReq--><path codeLine="54" d="M1089.77,254.11 C1105.5,263.77 1121.32,273.91 1136,284 C1156.9,298.37 1179.08,315.77 1197.23,330.62 " fill="none" id="AuthenticationController-to-RefreshReq" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="1201.27,333.94,1196.8426,325.1424,1197.4021,330.7715,1191.773,331.331,1201.27,333.94" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[6e0bd0fe5c38886e233a90bc1556f517]
link AuthenticationController to RefreshRes--><path codeLine="55" d="M1158.41,212.94 C1221.93,229.79 1287.32,260.22 1326,315 C1372.14,380.35 1332.46,479.15 1305.66,530.8 " fill="none" id="AuthenticationController-to-RefreshRes" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="1303.27,535.34,1311.0071,529.2459,1305.6029,530.9176,1303.9312,525.5134,1303.27,535.34" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[3ea7b854100ff602a8351ac560c3c0f6]
link AuthenticationController to ValidateEmailReq--><path codeLine="56" d="M915.65,254.23 C888.47,279.92 857.99,308.71 835.15,330.29 " fill="none" id="AuthenticationController-to-ValidateEmailReq" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="831.27,333.96,840.5585,330.6852,834.9039,330.5256,835.0635,324.871,831.27,333.96" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[2adfbe990a12dc04df57f2a2ca8f6ba0]
link App to AuthenticationController--><path codeLine="58" d="M981,68.17 C981,83.96 981,104.07 981,123.41 " fill="none" id="App-to-AuthenticationController" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="981,128.83,985,119.83,981,123.83,977,119.83,981,128.83" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[b8f32eef931d702e24f753698d2e89d8]
link AuthenticationController to UserModel--><path codeLine="64" d="M1158.12,219.89 C1230.88,234.3 1315.01,255.13 1388,284 C1418.96,296.25 1451.18,314.96 1476.38,331.16 " fill="none" id="AuthenticationController-to-UserModel" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1480.68,333.94,1475.2922,325.6955,1476.4806,331.2261,1470.95,332.4145,1480.68,333.94" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[4ecea6bf7c2c095d84c358f3c79267fb]
reverse link UserModel to User--><path codeLine="84" d="M1523,408.68 C1523,432.68 1523,463.22 1523,490.92 " fill="none" id="UserModel-backto-User" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1523,395.37,1519,401.37,1523,407.37,1527,401.37,1523,395.37" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="1524" y="457.0669">users</text><!--MD5=[aae85a0716fb9b9834068223de5a5f5e]
@startuml Authentication Class Diagram

class App {
    -SERVER_SECRET: string
}

class TokenContent {
    +username: string
    +expiration: number
}

class AuthenticationController {
    +signUp(req: SignUpReq, res: Object) : void
    +validateEmail(req: ValidateEmailReq, res: Object): void
    +login(req: LoginReq, res: Object) : void
    -signToken(content: TokenContent, secret: string) : string
    +refresh(req: RefreshReq, res: Object) : void
    -extractToken(token: string, secret: string) : TokenContent
}

AuthenticationController - -> TokenContent
AuthenticationController - -> ValidateEmail

interface SignUpReq {
    +email: string
    +username: string
    +passwordHash: string
}

interface ValidateEmailReq {
    +token: string
}

interface LoginReq {
    +username: string
    +passwordHash: string
}
interface LoginRes {
    +access_token: string
    +refresh_token: string
}
LoginReq -[hidden]-> LoginRes

interface RefreshReq {
    +refresh_token: string
}
interface RefreshRes {
    +new_access_token: string
}
RefreshReq -[hidden]-> RefreshRes

AuthenticationController ..> SignUpReq
AuthenticationController ..> LoginReq
AuthenticationController ..> LoginRes
AuthenticationController ..> RefreshReq
AuthenticationController ..> RefreshRes
AuthenticationController ..> ValidateEmailReq

App - -> AuthenticationController

class UserModel {
    +findOne(username: string) : User
}

AuthenticationController - -> UserModel

class User {
    +id: ObjectId
    +email: string
    +validatedEmail: boolean
    +username: string
    +passwordHash: string
    +authToken: string
    +refreshToken: string
    +isValidPassword() : boolean
}

class ValidateEmail {
    +userToToken: Map<ObjectId, string>
    +{static} sendTokenToEmail(user: ObjectId, email: string): void
    +{static} checkToken(user: ObjectId, token: string): boolean
    -generateValidationToken(): string
}

UserModel *- - User : users

@enduml

PlantUML version 1.2020.22(Sun Dec 06 12:36:27 TRT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>